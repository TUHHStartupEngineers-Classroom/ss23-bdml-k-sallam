{"title":"03 Automated Machine Learning with H20","markdown":{"yaml":{"title":"03 Automated Machine Learning with H20","date":"2023-06-08","output":{"html_document":{"toc":true,"toc_float":true,"df_print":"paged","collapsed":false,"number_sections":true,"toc_depth":3,"code_folding":"hide"}}},"headingText":"Automated Machine Learning with H20 (I) Challenge","containsRefs":false,"markdown":"\n\n```{r setup, include=FALSE}\nknitr::opts_chunk$set(\n    eval = FALSE,\n    message = FALSE,\n    warning = FALSE\n    )\n```\n\n\n\n## Loading libraries\n```{r}\nlibrary(h2o)\nlibrary(tidyverse)\nlibrary(readxl)\nlibrary(skimr)\nlibrary(GGally)\nlibrary(ggplot2)\nlibrary(rmarkdown)\nlibrary(rsample)\nlibrary(recipes)\nlibrary(PerformanceAnalytics)\n``` \n\n\n## Q1:\n\nThe answer is C\n```{r}\n#Q1\nemployee_attrition_tbl %>%\n  select(Attrition, contains(\"income\")) %>%\n  plot_ggpairs(Attrition)\n#The answer is C\n```\n\n\n## Q2:\n\nThe answer is D\n```{r}\n#Q2\nemployee_attrition_tbl %>%\n  select(Attrition, contains(\"PercentSalaryHike\")) %>%\n  plot_ggpairs(Attrition)\n\n#The answer is D\n```\n\n\n## Q3\n\nThe answer is B\n```{r}\n#Q3\nemployee_attrition_tbl %>%\n  select(Attrition, contains(\"StockOptionLevel\")) %>%\n  plot_ggpairs(Attrition)\n\n#The answer is B\n```\n\n## Q4\n\nThe answer is A\n```{r}\n#Q4\n\nemployee_attrition_tbl %>%\n  select(Attrition, contains(\"EnvironmentSatisfaction\")) %>%\n  plot_ggpairs(Attrition)\n\n#The answer is A\n```\n\n## Q5\n\nThe answer is B\n```{r}\n#Q5\n\nemployee_attrition_tbl %>%\n  select(Attrition, contains(\"WorkLifeBalance\")) %>%\n  plot_ggpairs(Attrition)\n\n#The answer is B\n```\n\n## Q6\n\nThe answer is A\n```{r}\n#Q6\n\nemployee_attrition_tbl %>%\n  select(Attrition, contains(\"JobInvolvement\")) %>%\n  plot_ggpairs(Attrition)\n\n#The answer is A\n```\n\n## Q7\n\nThe answer is B\n```{r}\n#Q7\nemployee_attrition_tbl %>%\n  select(Attrition, contains(\"OverTime\")) %>%\n  plot_ggpairs(Attrition)\n\n#The answer is B\n```\n\n## Q8\n\nThe answer is B\n```{r}\n#Q8\nemployee_attrition_tbl %>%\n  select(Attrition, contains(\"TrainingTimesLastYear\")) %>%\n  plot_ggpairs(Attrition)\n\n#The answer is B\n```\n\n## Q9\n The answer is B\n```{r}\n#Q9\nemployee_attrition_tbl %>%\n  select(Attrition, contains(\"YearsAtCompany\")) %>%\n  plot_ggpairs(Attrition)\n#The answer is B\n```\n\n## Q10\n\nThe answer is C\n```{r}\n#Q 10\nemployee_attrition_tbl %>%\n  select(Attrition, contains(\"YearsSinceLastPromotion\")) %>%\n  plot_ggpairs(Attrition)\n\n#The answer is C\n```\n\n\n# Automated Machine Learning with H20 (II) Challenge\n\n\n## Loading data\n```{r}\nproduct_backorders_tbl <- read_csv(\"product_backorders.csv\")\n```\n\n\n\n## Split into test and train\n```{r}\nset.seed(seed = 1113)\nsplit_obj <- rsample::initial_split(product_backorders_tbl, prop = 0.85)\n```\n\n\n## Assign training and test data\n\n```{r}\ntrain_readable_tbl<- training(split_obj)\ntest_readable_tbl <- testing(split_obj)\n\n\n  recipe_obj <- recipe( went_on_backorder~., data = train_readable_tbl) %>%\n  step_zv(all_predictors()) %>%\n  prep()\n\ntrain_tbl <- bake(recipe_obj, new_data = train_readable_tbl)\ntest_tbl  <- bake(recipe_obj, new_data = test_readable_tbl)\n\n #set the predictor names\n predictors <- c(\"national_inv\", \"lead_time\", \"forecast_3_month\", \"sales_3_month\")\n\n```\n\n\n## specify the response\n```{r}\n response <- \"went_on_backorder\"\n```\n\n## Automated machine learning Model\n\n### Initiate H2O\n\n```{r}\nh2o.init()\n```\n\n\n### Split data into a training and a validation data frame\n\n```{r}\n# Setting the seed is just for reproducability\n split_h2o <- h2o.splitFrame(as.h2o(train_tbl), ratios = c(0.85), seed = 1234)\n train_h2o <- split_h2o[[1]]\n valid_h2o <- split_h2o[[2]]\n test_h2o  <- as.h2o(test_tbl)\n```\n\n\n\n### Set the target and predictors\n```{r}\n y <- response\n x <- setdiff(names(train_h2o), y)\n```\n\n### Predicting using Leader Model\n\n```{r}\n ?h2o.automl\n\n automl_models_h2o <- h2o.automl(\n   x = x,\n   y = y,\n   training_frame    = train_h2o,\n   validation_frame  = valid_h2o,\n   leaderboard_frame = test_h2o,\n   max_runtime_secs  = 15,\n   nfolds            = 5\n )\n automl_models_h2o@leaderboard\n\n\n Model<-automl_models_h2o@leader\n```\n\n\n### Saving The Leader Model\n\n```{r}\nh2o.saveModel(Model,path = \"ml_journal-KhaledSallam\")\n```"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"paged","error":false,"eval":true,"cache":true,"freeze":"auto","echo":true,"output":{"html_document":{"toc":true,"toc_float":true,"df_print":"paged","collapsed":false,"number_sections":true,"toc_depth":3,"code_folding":"hide"}},"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":true,"code-line-numbers":true,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","filters":["lightbox"],"highlight-style":"a11y-dark","toc":true,"toc-depth":2,"number-sections":true,"output-file":"03_ml_aut.html"},"language":{"code-summary":"Show the code"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.2.475","lightbox":"auto","theme":{"dark":"darkly","light":"flatly"},"author":"Joschka Schwarz","knitr":{"opts_chunk":{"comment":"#>","R.options":"dplyr.summarise.inform = FALSE"}},"toc-title":"Contents","number-depth":2,"title":"03 Automated Machine Learning with H20","date":"2023-06-08"},"extensions":{"book":{"multiFile":true}}}}}